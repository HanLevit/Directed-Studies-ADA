
### Loading Libraries 
```{r}
library(ggplot2)
library(tidyverse)
library(DHARMa)
library(mgcv)
library(fitdistrplus)
library(goft)
library(gamlss)
library(patchwork)
library(MASS)
# do i need all of these?
```


### ALARIA ###

### SPORE SETTLEMENT TRIAL 1

```{r}
alaria_trial_all_data = read.csv("data/alaria_trials_combined.csv")

alaria_trial1_data <- alaria_trial_all_data %>%
  filter(Trial == "1", .preserve = FALSE)

```

```{r}
my_cols1 = c("Sound" = "khaki2", "Control" = "indianred3")

ggplot(alaria_trial1_data, aes(x = Treatment,
                                                     y = Settlement, fill = Treatment)) + 
  geom_point(aes(colour = Treatment), position = position_jitterdodge()) +
  geom_boxplot(alpha = 0.7) +
  scale_color_manual(values = my_cols1) +
  scale_fill_manual(values = my_cols1) + 
  theme_classic() +
  labs(x = "Trial 1", y = "Spore Settlement") +
  theme(axis.title = element_text(size = 10)) +
  scale_x_discrete(labels = c("Control", "20 kHz")) +
  theme(legend.position = "none") 

```

```{r}
alaria_trial1.mod <- lm(Settlement ~ Treatment, data = alaria_trial1_data)
summary(alaria_trial1.mod)
```
Adjusted R-squared:  0.05794 
F-statistic: 1.923 on 1 and 14 DF,  p-value: 0.1873

```{r}
shapiro.test(alaria_trial1_data$Settlement)
```
W = 0.97191, p-value = 0.8685

```{r}
t.test(Settlement ~ Treatment, data = alaria_trial1_data, 
       alternative = "two.sided", var.equal = T, conf.level = 0.95)

# assuming normality testing similarity of means
```
t = 1.3866, df = 14, p-value = 0.1873
95 percent confidence interval: -0.0006197266  0.0028863933
mean in group 20 kHz: 0.006125000 
mean in group Control: 0.004991667 
                        
```{r}
alaria_trial1.aov <- aov(Settlement ~ Treatment, data = alaria_trial1_data)
summary(alaria_trial1.aov)
```
            Df    Sum Sq   Mean Sq F value Pr(>F)
Treatment    1 5.140e-06 5.138e-06   1.923  0.187
Residuals   14 3.741e-05 2.672e-06 

```{r}
var.test(Settlement ~ Treatment, data = alaria_trial1_data, 
         alternative = "two.sided")
```
F = 1.2514, num df = 7, denom df = 7, p-value = 0.7749
95 percent confidence interval: 0.2505374 6.2506868
ratio of variances: 1.251411 


### ALARIA SETTLEMENT TRIAL 2

```{r}
alaria_trial_all_data = read.csv("data/alaria_trials_combined.csv")

alaria_trial2_data <- alaria_trial_all_data %>%
  filter(Trial == "2", .preserve = FALSE)
```

```{r}
my_cols2 = c("Sound" = "khaki2", "Control" = "indianred3")

ggplot(alaria_trial2_data, aes(x = Treatment,
                                                     y = Settlement, fill = Treatment)) + 
  geom_point(aes(colour = Treatment), position = position_jitterdodge()) +
  geom_boxplot(alpha = 0.7) +
  scale_color_manual(values = my_cols2) +
  scale_fill_manual(values = my_cols2) + 
  theme_classic() +
  labs(x = "Trial 2", y = "Spore Settlement") +
  theme(axis.title = element_text(size = 10)) +
  scale_x_discrete(labels = c("Control", "20 kHz")) +
  theme(legend.position = "none") 
  
```

```{r}
alaria_trial2.mod <- lm(Settlement ~ Treatment, data = alaria_trial2_data)
summary(alaria_trial2.mod)
```
Adjusted R-squared:  0.3091 
F-statistic:  7.71 on 1 and 14 DF,  p-value: 0.01484

```{r}
shapiro.test(alaria_trial2_data$Settlement)
```
W = 0.97508, p-value = 0.9126
normal

```{r}
t.test(Settlement ~ Treatment, data = alaria_trial2_data, 
       alternative = "two.sided", var.equal = T, conf.level = 0.95)

# assuming normality testing similarity of means
```
t = 2.7767, df = 14, p-value = 0.01484
95 percent confidence interval: 0.0004090247 0.0031854198
mean in group 20 kHz 0.006788889
mean in group Control 0.004991667 
                     
                        
```{r}
alaria_trial2.aov <- aov(Settlement ~ Treatment, data = alaria_trial2_data)
summary(alaria_trial2.aov)
```
            Df    Sum Sq   Mean Sq F value Pr(>F)  
Treatment    1 1.292e-05 1.292e-05    7.71 0.0148 *
Residuals   14 2.346e-05 1.676e-06  

```{r}
var.test(Settlement ~ Treatment, data = alaria_trial2_data, 
         alternative = "two.sided")
```
F = 2.4285, num df = 7, denom df = 7, p-value = 0.2646
95 percent confidence interval: 0.4862034   12.1303458
ratio of variances: 2.428542 


----------------------------------------------------------------------------

### ALARIA SETTLEMENT TRIAL 3

```{r}
alaria_trial_all_data = read.csv("data/alaria_trials_combined.csv")

alaria_trial3_data <- alaria_trial_all_data %>%
  filter(Trial == "3", .preserve = FALSE)

```

```{r}
my_cols1 = c("Sound" = "khaki2", "Control" = "indianred3")

ggplot(alaria_trial3_data, aes(x = Treatment, y = Settlement, fill = Treatment)) + 
  geom_point(aes(colour = Treatment), position = position_jitterdodge()) +
  geom_boxplot(alpha = 0.7) +
  scale_color_manual(values = my_cols1) +
  scale_fill_manual(values = my_cols1) + 
  theme_classic() +
  labs(x = "Trial 3", y = "Spore Settlement") +
  theme(axis.title = element_text(size = 10)) +
  scale_x_discrete(labels = c("Control", "20 kHz")) +
  theme(legend.position = "none") 
  
```

```{r}
alaria_trial3.mod <- lm(Settlement ~ Treatment, data = alaria_trial3_data)
summary(alaria_trial3.mod)
```
Adjusted R-squared:  0.115 
F-statistic: 2.949 on 1 and 14 DF,  p-value: 0.108

               Estimate Std. Error t value Pr(>|t|)    
(Intercept)      12.800      1.047  12.220 7.41e-09 ***
TreatmentSound    2.544      1.481   1.717    0.108  

```{r}
shapiro.test(alaria_trial3_data$Settlement)
```
W = 0.93167, p-value = 0.259
normal

```{r}
t.test(Settlement ~ Treatment, data = alaria_trial3_data, 
       alternative = "two.sided", var.equal = T, conf.level = 0.95)

# assuming normality testing similarity of means
```
t = -1.7172, df = 14, p-value = 0.108
95 percent confidence interval:
 -5.7209272  0.6334272
mean in group Control   mean in group Sound 
             12.80000              15.34375 
                     
                        
```{r}
alaria_trial3.aov <- aov(Settlement ~ Treatment, data = alaria_trial3_data)
summary(alaria_trial3.aov)
```
            Df Sum Sq Mean Sq F value Pr(>F)
Treatment    1  25.88  25.883   2.949  0.108
Residuals   14 122.89   8.778 

```{r}
var.test(Settlement ~ Treatment, data = alaria_trial3_data, 
         alternative = "two.sided")
```
F = 0.38577, num df = 7, denom df = 7, p-value = 0.2321
95 percent confidence interval:0.07723239   1.92687995
ratio of variances: 0.3857688 


----------------------------------------------------------------------------

### ALARIA SETTLEMENT TRIAL 4

```{r}
alaria_trial_all_data = read.csv("data/alaria_trials_combined.csv")

alaria_trial4_data <- alaria_trial_all_data %>%
  filter(Trial == "4", .preserve = FALSE)

```

```{r}
my_cols1 = c("Sound" = "khaki2", "Control" = "indianred3")

ggplot(alaria_trial4_data, aes(x = Treatment, y = Settlement, fill = Treatment)) + 
  geom_point(aes(colour = Treatment), position = position_jitterdodge()) +
  geom_boxplot(alpha = 0.7) +
  scale_color_manual(values = my_cols1) +
  scale_fill_manual(values = my_cols1) + 
  theme_classic() +
  labs(x = "Trial 4", y = "Spore Settlement") +
  theme(axis.title = element_text(size = 10)) +
  scale_x_discrete(labels = c("Control", "20 kHz")) +
  theme(legend.position = "none") 
  
```

```{r}
alaria_trial4.mod <- lm(Settlement ~ Treatment, data = alaria_trial4_data)
summary(alaria_trial4.mod)
```
Adjusted R-squared:  0.1849 
F-statistic: 4.403 on 1 and 14 DF,  p-value: 0.0545

               Estimate Std. Error t value Pr(>|t|)    
(Intercept)      12.800      1.146  11.172 2.33e-08 ***
TreatmentSound    3.400      1.620   2.098   0.0545 

```{r}
shapiro.test(alaria_trial4_data$Settlement)
```
W = 0.92744, p-value = 0.222
normal

```{r}
t.test(Settlement ~ Treatment, data = alaria_trial4_data, 
       alternative = "two.sided", var.equal = T, conf.level = 0.95)

# assuming normality testing similarity of means
```
t = -2.0983, df = 14, p-value = 0.0545
95 percent confidence interval: -6.87529303  0.07529303
mean in group Control   mean in group Sound 
                 12.8                  16.2 
                     
                        
```{r}
alaria_trial4.aov <- aov(Settlement ~ Treatment, data = alaria_trial4_data)
summary(alaria_trial4.aov)
```
            Df Sum Sq Mean Sq F value Pr(>F)  
Treatment    1  46.24   46.24   4.403 0.0545 .
Residuals   14 147.03   10.50                 

```{r}
var.test(Settlement ~ Treatment, data = alaria_trial4_data, 
         alternative = "two.sided")
```
F = 0.30322, num df = 7, denom df = 7, p-value = 0.1381
95 percent confidence interval:0.06070511  1.51453904
ratio of variances: 0.3032165 

```{r}
alaria_trial_all_data = read.csv("data/alaria_trials_combined.csv")

alaria_trial_all.mod <- lm(Settlement ~ Treatment, data = alaria_trial_all_data)
summary(alaria_trial_all.mod)
```
Adjusted R-squared:  0.1685 
F-statistic: 13.76 on 1 and 62 DF,  p-value: 0.0004451

               Estimate Std. Error t value Pr(>|t|)    
(Intercept)     13.8875     0.7021   19.78  < 2e-16 ***
TreatmentSound   3.6839     0.9929    3.71 0.000445 ***

```{r}
shapiro.test(alaria_trial_all_data$Settlement)
```
W = 0.9665, p-value = 0.07948
normal

```{r}
t.test(Settlement ~ Treatment, data = alaria_trial_all_data, 
       alternative = "two.sided", var.equal = T, conf.level = 0.95)

# assuming normality testing similarity of means
```
t = -3.7101, df = 62, p-value = 0.0004451
95 percent confidence interval:
 -5.668697 -1.699011
sample estimates:
mean in group Control   mean in group Sound 
             13.88750              17.57135 
                     

```{r}
var.test(Settlement ~ Treatment, data = alaria_trial_all_data, 
         alternative = "two.sided")
```
F = 0.70788, num df = 31, denom df = 31, p-value = 0.3412
95 percent confidence interval: 0.3455484 1.4501590
ratio of variances: 0.7078843 

------------------------------------------------------------------------------

### ALL FOUR TRIALS IN ONE FIGURE

```{r}
library(patchwork)
library(ggplot2)

my_cols1 = c("Sound" = "khaki2", "Control" = "indianred3")

alaria_trial_all_data = read.csv("data/alaria_trials_combined.csv")

alaria_trial1_graph = ggplot(alaria_trial1_data, 
                             aes(x = Treatment, y = Settlement, fill = Treatment)) + 
  geom_point(aes(colour = Treatment), position = position_jitterdodge()) +
  geom_boxplot(alpha = 0.7) +
  scale_color_manual(values = my_cols1) +
  scale_fill_manual(values = my_cols1) + 
  theme_classic() +
  labs(x = "Trial 1", y = "Spore Settlement") +
  theme(axis.title = element_text(size = 13)) +
  scale_x_discrete(labels = c("Control", "20 kHz")) +
  theme(legend.position = "none") 

alaria_trial2_graph = ggplot(alaria_trial1_data, 
                             aes(x = Treatment, y = Settlement, fill = Treatment)) + 
  geom_point(aes(colour = Treatment), position = position_jitterdodge()) +
  geom_boxplot(alpha = 0.7) +
  scale_color_manual(values = my_cols1) +
  scale_fill_manual(values = my_cols1) + 
  theme_classic() +
  labs(x = "Trial 2", y = "Spore Settlement") +
  theme(axis.title = element_text(size = 13)) +
  scale_x_discrete(labels = c("Control", "20 kHz")) +
  theme(legend.position = "none") 

alaria_trial3_graph = ggplot(alaria_trial3_data, 
                             aes(x = Treatment, y = Settlement, fill = Treatment)) + 
  geom_point(aes(colour = Treatment), position = position_jitterdodge()) +
  geom_boxplot(alpha = 0.7) +
  scale_color_manual(values = my_cols1) +
  scale_fill_manual(values = my_cols1) + 
  theme_classic() +
  labs(x = "Trial 3", y = "Spore Settlement") +
  theme(axis.title = element_text(size = 13)) +
  scale_x_discrete(labels = c("Control", "20 kHz")) +
  theme(legend.position = "none") 

alaria_trial4_graph = ggplot(alaria_trial4_data, 
                             aes(x = Treatment, y = Settlement, fill = Treatment)) + 
  geom_point(aes(colour = Treatment), position = position_jitterdodge()) +
  geom_boxplot(alpha = 0.7) +
  scale_color_manual(values = my_cols1) +
  scale_fill_manual(values = my_cols1) + 
  theme_classic() +
  labs(x = "Trial 4", y = "Spore Settlement") +
  theme(axis.title = element_text(size = 13)) +
  scale_x_discrete(labels = c("Control", "20 kHz")) +
  theme(legend.position = "none") 


combined_graph = ggplot(alaria_trial_all_data, aes(x = Treatment, y = Settlement, fill = Treatment)) + 
  geom_point(aes(colour = Treatment), position = position_jitterdodge()) +
  geom_boxplot(alpha = 0.7) +
  scale_color_manual(values = my_cols1) +
  scale_fill_manual(values = my_cols1) + 
  theme_classic() +
  labs(x = "Alaria marginata Combined Data", y = "Spore Settlement") +
  theme(axis.title = element_text(size = 13)) +
  scale_x_discrete(labels = c("Control", "20 kHz")) +
  theme(legend.position = "none")  

```

```{r}
spore_settlement_alaria = (alaria_trial1_graph | alaria_trial2_graph) / (alaria_trial3_graph | alaria_trial4_graph) / (combined_graph)
spore_settlement_alaria+ plot_annotation(tag_levels = 'A')

```



testing push from new project
