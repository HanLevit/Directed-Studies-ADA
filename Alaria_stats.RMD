
### Loading Libraries 
```{r}
library(ggplot2)
library(tidyverse)
library(DHARMa)
library(mgcv)
library(fitdistrplus)
library(goft)
library(gamlss)
library(patchwork)
library(MASS)
# do i need all of these?
```


### ALARIA ###

### SPORE SETTLEMENT TRIAL 1

```{r}
alaria_trial1_data <- read.csv("alaria_trial1_data.csv")
```

```{r}
my_cols7 = c("20 kHz" = "khaki2", "Control" = "indianred3")

ggplot(alaria_trial1_data, aes(x = Treatment,
                                                     y = Settlement, fill = Treatment)) + 
  geom_point(aes(colour = Treatment), position = position_jitterdodge()) +
  geom_boxplot(alpha = 0.7) +
  scale_color_manual(values = my_cols7) +
  scale_fill_manual(values = my_cols7) + 
  theme_classic() +
  labs(x = "treatment", y = "# spores settled / concentration")

```

```{r}
alaria_trial1.mod <- lm(Settlement ~ Treatment, data = alaria_trial1_data)
summary(alaria_trial1.mod)
```
Adjusted R-squared:  0.05794 
F-statistic: 1.923 on 1 and 14 DF,  p-value: 0.1873

```{r}
shapiro.test(alaria_trial1_data$Settlement)
```
W = 0.97191, p-value = 0.8685

```{r}
t.test(Settlement ~ Treatment, data = alaria_trial1_data, 
       alternative = "two.sided", var.equal = T, conf.level = 0.95)

# assuming normality testing similarity of means
```
t = 1.3866, df = 14, p-value = 0.1873
95 percent confidence interval: -0.0006197266  0.0028863933
mean in group 20 kHz: 0.006125000 
mean in group Control: 0.004991667 
                        
```{r}
alaria_trial1.aov <- aov(Settlement ~ Treatment, data = alaria_trial1_data)
summary(alaria_trial1.aov)
```
            Df    Sum Sq   Mean Sq F value Pr(>F)
Treatment    1 5.140e-06 5.138e-06   1.923  0.187
Residuals   14 3.741e-05 2.672e-06 

```{r}
var.test(Settlement ~ Treatment, data = alaria_trial1_data, 
         alternative = "two.sided")
```
F = 1.2514, num df = 7, denom df = 7, p-value = 0.7749
95 percent confidence interval: 0.2505374 6.2506868
ratio of variances: 1.251411 


### ALARIA SETTLEMENT TRIAL 2

```{r}
alaria_trial2_data <- read.csv("alaria_trial2_data.csv")
```

```{r}
ggplot(alaria_trial2_data, aes(x = Treatment, y = Settlement, fill = Treatment)) + 
  geom_point(aes(colour = Treatment), position = position_jitterdodge()) +
  geom_boxplot(alpha = 0.7) +
  scale_color_manual(values = my_cols7) +
  scale_fill_manual(values = my_cols7) + 
  theme_classic() +
  labs(x = "treatment", y = "# spores settled / concentration") +
  
```

```{r}
alaria_trial2.mod <- lm(Settlement ~ Treatment, data = alaria_trial2_data)
summary(alaria_trial2.mod)
```
Adjusted R-squared:  0.3091 
F-statistic:  7.71 on 1 and 14 DF,  p-value: 0.01484

```{r}
shapiro.test(alaria_trial2_data$Settlement)
```
W = 0.97508, p-value = 0.9126

```{r}
t.test(Settlement ~ Treatment, data = alaria_trial2_data, 
       alternative = "two.sided", var.equal = T, conf.level = 0.95)

# assuming normality testing similarity of means
```
t = 2.7767, df = 14, p-value = 0.01484
95 percent confidence interval: 0.0004090247 0.0031854198
mean in group 20 kHz 0.006788889
mean in group Control 0.004991667 
                     
                        
```{r}
alaria_trial2.aov <- aov(Settlement ~ Treatment, data = alaria_trial2_data)
summary(alaria_trial2.aov)
```
            Df    Sum Sq   Mean Sq F value Pr(>F)  
Treatment    1 1.292e-05 1.292e-05    7.71 0.0148 *
Residuals   14 2.346e-05 1.676e-06  

```{r}
var.test(Settlement ~ Treatment, data = alaria_trial2_data, 
         alternative = "two.sided")
```
F = 0.41177, num df = 7, denom df = 7, p-value = 0.2646
95 percent confidence interval: 0.08243788   2.05675248
ratio of variances:  0.4117697 



------------------------------------------------------------------------------

### ALL FOUR TRIALS IN ONE FIGURE

```{r}
library(patchwork)
library(ggplot2)

my_cols7 = c("20 kHz" = "khaki2", "Control" = "indianred3")

alaria_trial1_graph = ggplot(alaria_trial1_data, 
                             aes(x = Treatment, y = Settlement, fill = Treatment)) + 
  geom_point(aes(colour = Treatment), position = position_jitterdodge()) +
  geom_boxplot(alpha = 0.7) +
  scale_color_manual(values = my_cols7) +
  scale_fill_manual(values = my_cols7) + 
  theme_classic() +
  labs(x = "treatment", y = "# spores settled / concentration")

alaria_trial2_graph = ggplot(alaria_trial2_data, 
                             aes(x = Treatment, y = Settlement, fill = Treatment)) + 
  geom_point(aes(colour = Treatment), position = position_jitterdodge()) +
  geom_boxplot(alpha = 0.7) +
  scale_color_manual(values = my_cols7) +
  scale_fill_manual(values = my_cols7) + 
  theme_classic() +
  labs(x = "treatment", y = "# spores settled / concentration") +
  theme(legend.position = "none") 

alaria_trial2_graph = ggplot(alaria_trial2_data, 
                             aes(x = Treatment, y = Settlement, fill = Treatment)) + 
  geom_point(aes(colour = Treatment), position = position_jitterdodge()) +
  geom_boxplot(alpha = 0.7) +
  scale_color_manual(values = my_cols7) +
  scale_fill_manual(values = my_cols7) + 
  theme_classic() +
  labs(x = "treatment", y = "# spores settled / concentration") +
  theme(legend.position = "none") 

alaria_trial3_graph = ggplot(alaria_trial3_data, 
                             aes(x = Treatment, y = Settlement, fill = Treatment)) + 
  geom_point(aes(colour = Treatment), position = position_jitterdodge()) +
  geom_boxplot(alpha = 0.7) +
  scale_color_manual(values = my_cols7) +
  scale_fill_manual(values = my_cols7) + 
  theme_classic() +
  labs(x = "treatment", y = "# spores settled / concentration") +
  theme(legend.position = "none") 

alaria_trial3_graph = ggplot(alaria_trial3_data, 
                             aes(x = Treatment, y = Settlement, fill = Treatment)) + 
  geom_point(aes(colour = Treatment), position = position_jitterdodge()) +
  geom_boxplot(alpha = 0.7) +
  scale_color_manual(values = my_cols7) +
  scale_fill_manual(values = my_cols7) + 
  theme_classic() +
  labs(x = "treatment", y = "# spores settled / concentration") +
  theme(legend.position = "none") 

```

```{r}

spore_settlement_alaria = (alaria_trial1_graph | alaria_trial2_graph) / (alaria_trial3_graph | alaria_trial4_graph) / (combined_alaria_graph)
spore_settlement_alaria+ plot_annotation(tag_levels = 'A')


```



testing push from new project
