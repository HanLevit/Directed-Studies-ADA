---
title: "Graphs + Stats for DS experiment"
author: "Hannah Levit"
date: "15/11/2021"
output: html_document
---

```{r}
library(ggplot2)
library(tidyverse)
library(DHARMa)
library(mgcv)
library(fitdistrplus)
library(goft)
library(gamlss)
library(patchwork)
library(MASS)
```

```{r}
sound_results <- read.csv("data_for_R.csv")
```

```{r}
#level_order <- c('Control', 'Control', 'Control', 'Control',
#                 'Control', 'Control', 'Control', 'Control',
#                '20kHz', '20kHz', '20kHz', '20kHz',
#                 '20kHz', '20kHz', '20kHz', '20kHz')
#levels= level_order # this inside aes bracket
my_cols1 = c("20 kHz" = "orchid1", "Control" = "seagreen")

ggplot(sound_results, aes(x = Label, y = Value, fill = Label)) + 
  geom_point(aes(colour = Label), position = position_jitterdodge()) +
  geom_boxplot(alpha = 0.7) +
  scale_color_manual(values = my_cols1) +
  scale_fill_manual(values = my_cols1) + 
  theme_classic() +
  labs(x = "treatment", y = "# spores settled / concentration")


```
```{r}
sound_tankA_B <- read.csv("tank_A_and_B.csv")
```

```{r}
my_cols2 = c("20 kHz A" = "orchid1", "20 kHz B" = "lightpink1","Control A" = "seagreen", "Control B" = "springgreen3")

ggplot(sound_tankA_B, aes(x = Label, y = Value, fill = Label)) + 
  geom_point(aes(colour = Label), position = position_jitterdodge()) +
  geom_boxplot(alpha = 0.7) +
  scale_color_manual(values = my_cols2) +
  scale_fill_manual(values = my_cols2) + 
  theme_classic() +
  labs(x = "treatment", y = "# spores settled / concentration")

#make another graph with only treatment and no control to test if there 
# is a significant difference between tank A and B
```

```{r}
control1_tanks <- read.csv("control1_tanks.csv")
```

```{r}
treatment1_tanks <- read.csv("treatment1_tanks.csv")
```

```{r}
control1_tanks = sound_results %>%
  filter(Label == "Control A" | Label == "Control B")

treatment1_tanks = sound_results %>%
  filter(Label == "20 kHz A" | Label == "20 kHz B")

```

```{r}
control1.mod <- lm(Value ~ Label, data = control1_tanks)
summary(control1.mod)
```
Residual standard error: 0.002151 on 6 degrees of freedom
Multiple R-squared:  0.1214,	Adjusted R-squared:  -0.02501 
F-statistic: 0.8292 on 1 and 6 DF,  p-value: 0.3976

```{r}
treatment1.mod <- lm(Value ~ Label, data = treatment1_tanks)
summary(treatment1.mod)
```
Residual standard error: 0.0001801 on 6 degrees of freedom
Multiple R-squared:  0.6198,	Adjusted R-squared:  0.5565 
F-statistic: 9.783 on 1 and 6 DF,  p-value: 0.02038
- p is less than 0.05!!

```{r}
germinating_spores <- read.csv("germinating_ratio.csv")
```

```{r}
my_cols3 = c("20 kHz" = "orange1", "control" = "royalblue2")

ggplot(germinating_spores, aes(x = Treatment, y = Germinating.Settled, fill = Treatment)) + 
  geom_point(aes(colour = Treatment), position = position_jitterdodge()) +
  geom_boxplot(alpha = 0.7) +
  scale_color_manual(values = my_cols3) +
  scale_fill_manual(values = my_cols3) + 
  theme_classic() +
  labs(x = "treatment", y = "spores germinating / settled")
```

```{r}
sound.mod <- lm(Value ~ Label, data = sound_results)
summary(sound.mod)
```
Adjusted R-squared:  0.5556 
p-value: 0.0005553
- significant difference because P < 0.05

```{r}
shapiro.test(sound_results$Value)
```
Shapiro test: W = 0.82075, p-value = 0.005206

use fitDist function 

Best distribution: Family:  c("GG", "generalised Gamma Lopatatsidis-Green") 
Fitting method: "nlminb" 

```{r}
fitDist(Value, data = sound_results, type = "realAll", try.gamlss = T) 
histDist(sound_results$Value, "GG")
```
real0to1 in fit dist is good for data from 0 to 1 - ie proportion of germination

```{r}
t.test(Value ~ Label, data = sound_results, alternative = "two.sided", var.equal = T, conf.level = 0.95)

# assuming normality testing similarity of means
```
t = 4.4445, df = 14, p-value = 0.0005553
95 percent confidence interval:
  0.001741043   0.004988596
mean in group Control: 0.005634602 
mean in group Treatment 1: 0.002269783 
              
```{r}
aov <- aov(Value ~ Label, data = sound_results)
summary(aov)

# assuming normality so not as helpful
```
Df    Sum Sq   Mean Sq F value  Pr(>F)    
Label        5 7.066e-05 1.413e-05   21.01 5.2e-05 ***
Residuals   10 6.730e-06 6.730e-07  

```{r}
var.test(Value ~ Label, sound_results, 
         alternative = "two.sided")

# go back and fix data so no A or B
```
F = 0.01621, num df = 7, denom df = 7, p-value =
1.851e-05
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.003245242 0.080965929
sample estimates:
ratio of variances 
        0.01620969 


----------------------------------

```{r}
germinating.mod <- lm(Germinating.Settled ~ Treatment, data = germinating_spores)
summary(germinating.mod)
# consider adding in tank and do a linear model to account for random effects
```
Adjusted R-squared:  0.0007447 
p-value: 0.3071

```{r}
t.test(Germinating.Settled ~ Treatment, data = germinating_spores, alternative = "two.sided", var.equal = T, conf.level = 0.95)
# best explains the data because normal and equal variance!
```
t = -1.0283, df = 76, p-value = 0.3071
95 percent confidence interval:
   -0.08711297   0.02778934
mean in group 20 kHz: 0.5108839 
mean in group control: 0.5405457
                         
```{r}
shapiro.test(germinating_spores$Germinating.Settled)
```
Shapiro-Wilk normality test

data:  germinating_spores$Germinating.Settled
W = 0.97902, p-value = 0.226

  NORMAL DISTRIBUTION 
  - can use linear model and t test 
  - do bartlet test if variance is equal, anova if not


```{r}
var.test(Germinating.Settled ~ Treatment, germinating_spores, 
         alternative = "two.sided")
```
F = 1.0053, num df = 39, denom df = 37, p-value = 0.9895
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.5255553 1.9121672
sample estimates:
ratio of variances 
          1.005251 

ADD: Which distrubtion does it fit? 
ADD: f-test of variance







